<template>
    <div class="slds-p-around_medium">
        <lightning-progress-indicator 
            current-step={currentStep} 
            type="path"
            variant="base"
            steps={steps}>
        </lightning-progress-indicator>

        <div class="slds-m-top_medium">
            <!-- Page 1: Residential Viability -->
            <div if:true={isPage1}>
                <lightning-accordion 
                    allow-multiple-sections-open="true"
                    active-section-name={openSections}>
                    <lightning-accordion-section name="info" label="About this section">
                        <p>This section collects information about financial health and viability of residential care services.</p>
                    </lightning-accordion-section>
                </lightning-accordion>

                <div class="slds-card slds-m-top_medium">
                    <div class="slds-card__header">
                        <h2 class="slds-card__header-title">Solvency Assessment</h2>
                    </div>
                    <div class="slds-card__body slds-p-around_medium">
                        <lightning-radio-group
                            name="solvencyConcern"
                            label="Are you currently concerned about the solvency of your organisation?"
                            options={yesNoOptions}
                            value={solvencyConcern}
                            onchange={handleSolvencyConcernChange}
                            required>
                        </lightning-radio-group>

                        <lightning-radio-group
                            name="futureSolvency"
                            label="Do you envisage any solvency issues arising in the next six months?"
                            options={yesNoOptions}
                            value={futureSolvency}
                            onchange={handleFutureSolvencyChange}
                            required
                            class="slds-m-top_medium">
                        </lightning-radio-group>
                    </div>
                </div>

                <div class="slds-card slds-m-top_medium">
                    <div class="slds-card__header">
                        <h2 class="slds-card__header-title">Financial Performance Assessment</h2>
                    </div>
                    <div class="slds-card__body slds-p-around_medium">
                        <lightning-radio-group
                            name="operationalLoss"
                            label="Do you forecast an operational loss for the current year?"
                            options={yesNoOptions}
                            value={operationalLoss}
                            onchange={handleOperationalLossChange}
                            required>
                            <lightning-helptext
                                content="An operational loss occurs when operating expenses exceed operating revenues from your core care services.">
                            </lightning-helptext>
                        </lightning-radio-group>
                    </div>
                </div>
            </div>

            <!-- Labor Costs Data Table -->
            <div if:true={isLaborCostsPage}>
                <div class="slds-grid slds-gutters slds-m-bottom_medium">
                    <div class="slds-col">
                        <lightning-combobox
                            name="viewFilter"
                            label="View"
                            value={selectedView}
                            options={viewOptions}
                            onchange={handleViewChange}>
                        </lightning-combobox>
                    </div>
                    <div class="slds-col">
                        <lightning-combobox
                            name="jumpSection"
                            label="Jump to Section"
                            value={selectedSection}
                            options={sectionOptions}
                            onchange={handleSectionJump}>
                        </lightning-combobox>
                    </div>
                    <div class="slds-col">
                        <lightning-combobox
                            name="jumpColumn"
                            label="Jump to Column"
                            value={selectedColumn}
                            options={columnOptions}
                            onchange={handleColumnJump}>
                        </lightning-combobox>
                    </div>
                </div>

                <lightning-datatable
                    key-field="id"
                    data={laborCostsData}
                    columns={columns}
                    hide-checkbox-column
                    oncellchange={handleCellChange}>
                </lightning-datatable>
            </div>

            <!-- Navigation Buttons -->
            <div class="slds-m-top_medium slds-grid slds-grid_align-spread">
                <lightning-button 
                    label="Previous"
                    onclick={handlePrevious}
                    disabled={isPreviousDisabled}>
                </lightning-button>
                <lightning-button 
                    label={nextButtonLabel}
                    variant="brand"
                    onclick={handleNext}
                    disabled={isNextDisabled}>
                </lightning-button>
            </div>
        </div>
    </div>
</template>
