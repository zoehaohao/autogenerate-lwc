<template>
    <div class="slds-p-around_medium">
        <lightning-progress-indicator 
            current-step={currentStep} 
            type="path" 
            variant="base"
            steps={steps}>
        </lightning-progress-indicator>

        <div class="slds-m-top_medium">
            <!-- Page 1: Residential Viability -->
            <div if:true={isPageOne}>
                <lightning-accordion 
                    allow-multiple-sections-open="true"
                    active-section-name={openSections}
                    class="slds-m-bottom_medium">
                    <lightning-accordion-section name="info" label="About this section">
                        <p>This section collects information about financial health and viability of residential care services.</p>
                    </lightning-accordion-section>
                </lightning-accordion>

                <lightning-card title="Solvency Assessment">
                    <div class="slds-p-horizontal_medium">
                        <lightning-radio-group
                            name="solvencyConcern"
                            label="Are you currently concerned about the solvency of your organisation?"
                            options={yesNoOptions}
                            value={solvencyConcern}
                            onchange={handleSolvencyChange}
                            required>
                        </lightning-radio-group>

                        <lightning-radio-group
                            name="futureSolvency"
                            label="Do you envisage any solvency issues arising in the next six months?"
                            options={yesNoOptions}
                            value={futureSolvency}
                            onchange={handleFutureSolvencyChange}
                            required
                            class="slds-m-top_medium">
                        </lightning-radio-group>
                    </div>
                </lightning-card>

                <lightning-card title="Financial Performance" class="slds-m-top_medium">
                    <div class="slds-p-horizontal_medium">
                        <lightning-radio-group
                            name="operationalLoss"
                            label="Do you forecast an operational loss for the current year?"
                            options={yesNoOptions}
                            value={operationalLoss}
                            onchange={handleOperationalLossChange}
                            required>
                        </lightning-radio-group>
                    </div>
                </lightning-card>
            </div>

            <!-- Labor Costs Table -->
            <div if:true={isPageFour}>
                <lightning-card title="Labour Costs Data">
                    <div class="slds-p-horizontal_medium">
                        <div class="slds-grid slds-gutters slds-m-bottom_medium">
                            <div class="slds-col">
                                <lightning-combobox
                                    name="viewFilter"
                                    label="View"
                                    value={selectedView}
                                    options={viewOptions}
                                    onchange={handleViewChange}>
                                </lightning-combobox>
                            </div>
                            <div class="slds-col">
                                <lightning-combobox
                                    name="jumpSection"
                                    label="Jump to Section"
                                    value={selectedSection}
                                    options={sectionOptions}
                                    onchange={handleSectionJump}>
                                </lightning-combobox>
                            </div>
                            <div class="slds-col">
                                <lightning-combobox
                                    name="jumpColumn"
                                    label="Jump to Column"
                                    value={selectedColumn}
                                    options={columnOptions}
                                    onchange={handleColumnJump}>
                                </lightning-combobox>
                            </div>
                        </div>
                        
                        <lightning-datatable
                            key-field="id"
                            data={laborCostsData}
                            columns={laborColumns}
                            hide-checkbox-column
                            oncellchange={handleCellChange}>
                        </lightning-datatable>
                    </div>
                </lightning-card>
            </div>

            <!-- Navigation Buttons -->
            <div class="slds-m-top_medium slds-grid slds-grid_align-spread">
                <lightning-button 
                    label="Previous"
                    onclick={handlePrevious}
                    disabled={isPreviousDisabled}>
                </lightning-button>
                <lightning-button 
                    label={nextButtonLabel}
                    variant="brand"
                    onclick={handleNext}
                    disabled={isNextDisabled}>
                </lightning-button>
            </div>
        </div>
    </div>
</template>
