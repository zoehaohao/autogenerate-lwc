<template>
    <div class="slds-p-around_medium">
        <lightning-card title="Application For Approval To Provide Aged Care" icon-name="standard:form">
            <div class="slds-p-horizontal_medium">
                <lightning-accordion allow-multiple-sections-open="true" 
                                   active-section-name={openSections}
                                   onsectiontoggle={handleSectionToggle}>
                    
                    <!-- Section 1: Applicant Details -->
                    <lightning-accordion-section name="section1" label="Section 1: Applicant Details">
                        <div class="slds-grid slds-wrap">
                            <div class="slds-col slds-size_1-of-2 slds-p-right_medium">
                                <lightning-input 
                                    label="Applicant's (Company) Legal Name"
                                    required
                                    type="text"
                                    value={applicantDetails.legalName}
                                    onchange={handleInputChange}
                                    data-field="legalName">
                                </lightning-input>
                                
                                <lightning-input 
                                    label="Applicant's (Company) ACN/IAN/ICN"
                                    required
                                    type="text"
                                    value={applicantDetails.acn}
                                    onchange={handleInputChange}
                                    data-field="acn">
                                </lightning-input>
                                
                                <lightning-input 
                                    label="Business Name (if applicable)"
                                    type="text"
                                    value={applicantDetails.businessName}
                                    onchange={handleInputChange}
                                    data-field="businessName">
                                </lightning-input>
                            </div>
                            
                            <div class="slds-col slds-size_1-of-2">
                                <lightning-input 
                                    label="ABN"
                                    required
                                    type="text"
                                    value={applicantDetails.abn}
                                    onchange={handleInputChange}
                                    data-field="abn">
                                </lightning-input>
                            </div>
                        </div>
                    </lightning-accordion-section>
                    
                    <!-- Section 2: Key Personnel Details -->
                    <lightning-accordion-section name="section2" label="Section 2: Key Personnel Details">
                        <lightning-datatable
                            key-field="id"
                            data={keyPersonnelData}
                            columns={keyPersonnelColumns}
                            onrowaction={handleRowAction}
                            hide-checkbox-column>
                        </lightning-datatable>
                        
                        <div class="slds-p-top_medium">
                            <lightning-button 
                                label="Add Key Personnel" 
                                variant="neutral"
                                onclick={handleAddKeyPersonnel}>
                            </lightning-button>
                        </div>
                    </lightning-accordion-section>
                    
                    <!-- Section 3: Submit -->
                    <lightning-accordion-section name="section3" label="Section 3: Submit Application">
                        <div class="slds-grid slds-grid_align-center slds-p-top_medium">
                            <lightning-button 
                                label="Submit Application"
                                variant="brand"
                                onclick={handleSubmit}
                                disabled={isSubmitDisabled}>
                            </lightning-button>
                        </div>
                    </lightning-accordion-section>
                </lightning-accordion>
                
                <template if:true={showSpinner}>
                    <lightning-spinner alternative-text="Loading" size="medium"></lightning-spinner>
                </template>
            </div>
        </lightning-card>
    </div>
</template>
