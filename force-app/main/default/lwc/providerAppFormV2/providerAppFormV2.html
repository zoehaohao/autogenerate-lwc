<template>
    <div class="slds-card">
        <!-- Progress Indicator -->
        <div class="slds-card__header slds-border_bottom">
            <lightning-progress-indicator 
                current-step={currentPageString}
                type="path"
                variant="base">
                <lightning-progress-step 
                    label="Application Details" 
                    value="1">
                </lightning-progress-step>
                <lightning-progress-step 
                    label="Key Personnel" 
                    value="2">
                </lightning-progress-step>
                <lightning-progress-step 
                    label="Suitability Assessment" 
                    value="3">
                </lightning-progress-step>
                <lightning-progress-step 
                    label="Care Type & Review" 
                    value="4">
                </lightning-progress-step>
            </lightning-progress-indicator>
        </div>

        <div class="slds-card__body slds-card__body_inner">
            <!-- Loading Spinner -->
            <template if:true={isLoading}>
                <lightning-spinner alternative-text="Processing..." size="medium"></lightning-spinner>
            </template>

            <!-- Page 1: Application Details -->
            <template if:true={showPage1}>
                <div class="slds-p-around_medium">
                    <h2 class="slds-text-heading_large slds-m-bottom_medium">APPLICATION FOR APPROVAL TO PROVIDE AGED CARE - NEW APPLICANT</h2>
                    
                    <div class="slds-notify slds-notify_alert slds-theme_warning slds-theme_alert-texture slds-m-bottom_medium" role="alert">
                        <span class="slds-assistive-text">warning</span>
                        <h2 class="slds-text-heading_small">Important Information</h2>
                        <p>Before completing this application form, you must understand what it means to be an approved provider. Read the Aged Care Approved Provider Application Guide and ensure you are aware of the responsibilities and obligations of an approved provider prescribed in the Aged Care Act 1997.</p>
                    </div>

                    <lightning-accordion allow-multiple-sections-open>
                        <!-- Organization Details Section -->
                        <lightning-accordion-section name="orgDetails" label="Organization Details">
                            <div class="slds-grid slds-wrap slds-gutters">
                                <div class="slds-col slds-size_1-of-1 slds-large-size_1-of-2">
                                    <lightning-input
                                        label="Applicant's (Company) Legal Name"
                                        name="companyLegalName"
                                        value={formData.companyLegalName}
                                        onchange={handleFieldChange}
                                        required
                                        message-when-value-missing="Company Legal Name is required">
                                    </lightning-input>
                                </div>
                                <div class="slds-col slds-size_1-of-1 slds-large-size_1-of-4">
                                    <lightning-input
                                        label="ACN/IAN/ICN"
                                        name="companyNumber"
                                        value={formData.companyNumber}
                                        onchange={handleFieldChange}
                                        required
                                        message-when-value-missing="Company Number is required">
                                    </lightning-input>
                                </div>
                                <div class="slds-col slds-size_1-of-1 slds-large-size_1-of-4">
                                    <lightning-input
                                        label="ABN"
                                        name="abn"
                                        value={formData.abn}
                                        onchange={handleFieldChange}
                                        required
                                        message-when-value-missing="ABN is required">
                                    </lightning-input>
                                </div>
                                <div class="slds-col slds-size_1-of-1">
                                    <lightning-input
                                        label="Business Name (if applicable)"
                                        name="businessName"
                                        value={formData.businessName}
                                        onchange={handleFieldChange}>
                                    </lightning-input>
                                </div>
                            </div>
                        </lightning-accordion-section>

                        <!-- Registered Business Address Section -->
                        <lightning-accordion-section name="businessAddress" label="Registered Business Address">
                            <p class="slds-text-body_small slds-text-color_weak slds-m-bottom_small">Must be the registered physical address of the organisation</p>
                            <div class="slds-grid slds-wrap slds-gutters">
                                <div class="slds-col slds-size_1-of-1">
                                    <lightning-input
                                        label="Street Number and Name"
                                        name="businessStreetAddress"
                                        value={formData.businessStreetAddress}
                                        onchange={handleFieldChange}
                                        required
                                        message-when-value-missing="Street address is required">
                                    </lightning-input>
                                </div>
                                <div class="slds-col slds-size_1-of-1 slds-large-size_1-of-3">
                                    <lightning-input
                                        label="Suburb/Town"
                                        name="businessSuburb"
                                        value={formData.businessSuburb}
                                        onchange={handleFieldChange}
                                        required
                                        message-when-value-missing="Suburb/Town is required">
                                    </lightning-input>
                                </div>
                                <div class="slds-col slds-size_1-of-1 slds-large-size_1-of-3">
                                    <lightning-combobox
                                        label="State/Territory"
                                        name="businessState"
                                        value={formData.businessState}
                                        options={stateOptions}
                                        onchange={handleFieldChange}
                                        required
                                        message-when-value-missing="State/Territory is required">
                                    </lightning-combobox>
                                </div>
                                <div class="slds-col slds-size_1-of-1 slds-large-size_1-of-3">
                                    <lightning-input
                                        label="Postcode"
                                        name="businessPostcode"
                                        value={formData.businessPostcode}
                                        onchange={handleFieldChange}
                                        required
                                        message-when-value-missing="Postcode is required">
                                    </lightning-input>
                                </div>
                            </div>
                        </lightning-accordion-section>

                        <!-- Postal Address Section -->
                        <lightning-accordion-section name="postalAddress" label="Postal Address">
                            <div class="slds-form-element slds-m-bottom_small">
                                <lightning-input
                                    type="checkbox"
                                    label="Same as registered business address"
                                    name="sameAsBusinessAddress"
                                    checked={formData.sameAsBusinessAddress}
                                    onchange={handleFieldChange}>
                                </lightning-input>
                            </div>
                            <template if:false={formData.sameAsBusinessAddress}>
                                <div class="slds-grid slds-wrap slds-gutters">
                                    <div class="slds-col slds-size_1-of-1">
                                        <lightning-input
                                            label="Street Number and Name/PO Box"
                                            name="postalStreetAddress"
                                            value={formData.postalStreetAddress}
                                            onchange={handleFieldChange}>
                                        </lightning-input>
                                    </div>
                                    <div class="slds-col slds-size_1-of-1 slds-large-size_1-of-3">
                                        <lightning-input
                                            label="Suburb/Town"
                                            name="postalSuburb"
                                            value={formData.postalSuburb}
                                            onchange={handleFieldChange}>
                                        </lightning-input>
                                    </div>
                                    <div class="slds-col slds-size_1-of-1 slds-large-size_1-of-3">
                                        <lightning-combobox
                                            label="State/Territory"
                                            name="postalState"
                                            value={formData.postalState}
                                            options={stateOptions}
                                            onchange={handleFieldChange}>
                                        </lightning-combobox>
                                    </div>
                                    <div class="slds-col slds-size_1-of-1 slds-large-size_1-of-3">
                                        <lightning-input
                                            label="Postcode"
                                            name="postalPostcode"
                                            value={formData.postalPostcode}
                                            onchange={handleFieldChange}>
                                        </lightning-input>
                                    </div>
                                </div>
                            </template>
                        </lightning-accordion-section>

                        <!-- Care Type Selection -->
                        <lightning-accordion-section name="careType" label="Care Type Application">
                            <p class="slds-text-body_regular slds-m-bottom_medium">Select the type(s of care for which approval is sought. All applicants must complete Sections 2 and 3 of this application form, regardless of the type of care being applied for.</p>
                            <lightning-checkbox-group
                                label="Care Types"
                                name="careTypes"
                                options={careTypeOptions}
                                value={formData.careTypes}
                                onchange={handleFieldChange}
                                required
                                message-when-value-missing="At least one care type must be selected">
                            </lightning-checkbox-group>
                        </lightning-accordion-section>

                        <!-- Organization Type -->
                        <lightning-accordion-section name="orgType" label="Organization Type">
                            <p class="slds-text-body_small slds-text-color_weak slds-m-bottom_small">The following questions are used for statistical purposes and do not affect the assessment of this application.</p>
                            <div class="slds-grid slds-wrap slds-gutters">
                                <div class="slds-col slds-size_1-of-1 slds-large-size_1-of-2">
                                    <lightning-radio-group
                                        label="What is your organisation type?"
                                        name="organizationType"
                                        options={organizationTypeOptions}
                                        value={formData.organizationType}
                                        onchange={handleFieldChange}
                                        required>
                                    </lightning-radio-group>
                                </div>
                                <div class="slds-col slds-size_1-of-1 slds-large-size_1-of-2">
                                    <lightning-radio-group
                                        label="Is your organisation or its parent body listed on the Australian Stock Exchange?"
                                        name="stockExchangeListed"
                                        options={yesNoOptions}
                                        value={formData.stockExchangeListed}
                                        onchange={handleFieldChange}
                                        required>
                                    </lightning-radio-group>
                                </div>
                            </div>
                        </lightning-accordion-section>
                    </lightning-accordion>

                    <!-- Navigation buttons for Page 1 -->
                    <div class="slds-docked-form-footer slds-m-top_large">
                        <lightning-button 
                            label="Cancel" 
                            onclick={handleCancel}
                            variant="neutral">
                        </lightning-button>
                        <lightning-button 
                            label="Next" 
                            onclick={handleNext}
                            variant="brand"
                            class="slds-m-left_x-small">
                        </lightning-button>
                    </div>
                </div>
            </template>

            <!-- Page 2: Key Personnel -->
            <template if:true={showPage2}>
                <div class="slds-p-around_medium">
                    <h2 class="slds-text-heading_large slds-m-bottom_medium">KEY PERSONNEL DETAILS</h2>
                    
                    <div class="slds-notify slds-notify_alert slds-theme_info slds-theme_alert-texture slds-m-bottom_medium" role="alert">
                        <span class="slds-assistive-text">info</span>
                        <h2 class="slds-text-heading_small">Key Personnel Requirements</h2>
                        <p>Under Part 7A, subsection 63D(2)(c) of the Commission Act, the Commissioner must not approve a person as a provider of aged care unless the Commissioner is satisfied that each individual who is one of the key personnel of the person is suitable to be involved in the provision of aged care.</p>
                    </div>

                    <!-- Primary Contact -->
                    <lightning-accordion allow-multiple-sections-open>
                        <lightning-accordion-section name="primaryContact" label="Primary Contact Person">
                            <p class="slds-text-body_small slds-text-color_weak slds-m-bottom_small">The contact person(s) listed below must be key personnel and have knowledge of this applications content.</p>
                            <div class="slds-grid slds-wrap slds-gutters">
                                <div class="slds-col slds-size_1-of-1 slds-large-size_1-of-2">
                                    <lightning-input
                                        label="Full Name"
                                        name="primaryContactName"
                                        value={formData.primaryContactName}
                                        onchange={handleFieldChange}
                                        required
                                        message-when-value-missing="Primary contact name is required">
                                    </lightning-input>
                                </div>
                                <div class="slds-col slds-size_1-of-1 slds-large-size_1-of-2">
                                    <lightning-input
                                        label="Position Held"
                                        name="primaryContactPosition"
                                        value={formData.primaryContactPosition}
                                        onchange={handleFieldChange}
                                        required
                                        message-when-value-missing="Position is required">
                                    </lightning-input>
                                </div>
                                <div class="slds-col slds-size_1-of-1 slds-large-size_1-of-3">
                                    <lightning-input
                                        label="Telephone (incl area code)"
                                        name="primaryContactPhone"
                                        type="tel"
                                        value={formData.primaryContactPhone}
                                        onchange={handleFieldChange}
                                        required
                                        message-when-value-missing="Phone number is required">
                                    </lightning-input>
                                </div>
                                <div class="slds-col slds-size_1-of-1 slds-large-size_1-of-3">
                                    <lightning-input
                                        label="Mobile"
                                        name="primaryContactMobile"
                                        type="tel"
                                        value={formData.primaryContactMobile}
                                        onchange={handleFieldChange}>
                                    </lightning-input>
                                </div>
                                <div class="slds-col slds-size_1-of-1 slds-large-size_1-of-3">
                                    <lightning-input
                                        label="Best day and time to make contact"
                                        name="primaryContactBestTime"
                                        value={formData.primaryContactBestTime}
                                        onchange={handleFieldChange}>
                                    </lightning-input>
                                </div>
                                <div class="slds-col slds-size_1-of-1">
                                    <lightning-input
                                        label="Email Address"
                                        name="primaryContactEmail"
                                        type="email"
                                        value={formData.primaryContactEmail}
                                        onchange={handleFieldChange}
                                        required
                                        message-when-value-missing="Email address is required">
                                    </lightning-input>
                                </div>
                            </div>
                        </lightning-accordion-section>

                        <!-- Key Personnel 1 -->
                        <lightning-accordion-section name="keyPersonnel1" label="Key Personnel 1">
                            <div class="slds-grid slds-wrap slds-gutters">
                                <div class="slds-col slds-size_1-of-1 slds-large-size_1-of-6">
                                    <lightning-combobox
                                        label="Title"
                                        name="kp1Title"
                                        value={formData.kp1Title}
                                        options={titleOptions}
                                        onchange={handleFieldChange}>
                                    </lightning-combobox>
                                </div>
                                <div class="slds-col slds-size_1-of-1 slds-large-size_5-of-6">
                                    <lightning-input
                                        label="First and Last Name"
                                        name="kp1Name"
                                        value={formData.kp1Name}
                                        onchange={handleFieldChange}
                                        required
                                        message-when-value-missing="Name is required">
                                    </lightning-input>
                                </div>
                                <div class="slds-col slds-size_1-of-1 slds-large-size_1-of-2">
                                    <lightning-input
                                        label="Former Name (as applicable)"
                                        name="kp1FormerName"
                                        value={formData.kp1FormerName}
                                        onchange={handleFieldChange}>
                                    </lightning-input>
                                </div>
                                <div class="slds-col slds-size_1-of-1 slds-large-size_1-of-2">
                                    <lightning-input
                                        label="Preferred Name"
                                        name="kp1PreferredName"
                                        value={formData.kp1PreferredName}
                                        onchange={handleFieldChange}>
                                    </lightning-input>
                                </div>
                                <div class="slds-col slds-size_1-of-1 slds-large-size_1-of-2">
                                    <lightning-input
                                        label="Date of Birth"
                                        name="kp1DateOfBirth"
                                        type="date"
                                        value={formData.kp1DateOfBirth}
                                        onchange={handleFieldChange}
                                        required
                                        message-when-value-missing="Date of birth is required">
                                    </lightning-input>
                                </div>
                                <div class="slds-col slds-size_1-of-1 slds-large-size_1-of-2">
                                    <lightning-input
                                        label="Position Title"
                                        name="kp1Position"
                                        value={formData.kp1Position}
                                        onchange={handleFieldChange}
                                        required
                                        message-when-value-missing="Position title is required">
                                    </lightning-input>
                                </div>
                                <div class="slds-col slds-size_1-of-1">
                                    <lightning-textarea
                                        label="Principal duties of position"
                                        name="kp1Duties"
                                        value={formData.kp1Duties}
                                        onchange={handleFieldChange}
                                        required
                                        message-when-value-missing="Principal duties are required">
                                    </lightning-textarea>
                                </div>
                                <div class="slds-col slds-size_1-of-1 slds-large-size_1-of-2">
                                    <lightning-input
                                        label="Contact Email Address"
                                        name="kp1Email"
                                        type="email"
                                        value={formData.kp1Email}
                                        onchange={handleFieldChange}
                                        required
                                        message-when-value-missing="Email is required">
                                    </lightning-input>
                                </div>
                                <div class="slds-col slds-size_1-of-1 slds-large-size_1-of-2">
                                    <lightning-input
                                        label="Contact Phone Number - Mobile"
                                        name="kp1Mobile"
                                        type="tel"
                                        value={formData.kp1Mobile}
                                        onchange={handleFieldChange}>
                                    </lightning-input>
                                </div>
                            </div>
                        </lightning-accordion-section>

                        <!-- Key Personnel 2 -->
                        <lightning-accordion-section name="keyPersonnel2" label="Key Personnel 2">
                            <div class="slds-grid slds-wrap slds-gutters">
                                <div class="slds-col slds-size_1-of-1 slds-large-size_1-of-6">
                                    <lightning-combobox
                                        label="Title"
                                        name="kp2Title"
                                        value={formData.kp2Title}
                                        options={titleOptions}
                                        onchange={handleFieldChange}>
                                    </lightning-combobox>
                                </div>
                                <div class="slds-col slds-size_1-of-1 slds-large-size_5-of-6">
                                    <lightning-input
                                        label="First and Last Name"
                                        name="kp2Name"
                                        value={formData.kp2Name}
                                        onchange={handleFieldChange}>
                                    </lightning-input>
                                </div>
                                <div class="slds-col slds-size_1-of-1 slds-large-size_1-of-2">
                                    <lightning-input
                                        label="Position Title"
                                        name="kp2Position"
                                        value={formData.kp2Position}
                                        onchange={handleFieldChange}>
                                    </lightning-input>
                                </div>
                                <div class="slds-col slds-size_1-of-1 slds-large-size_1-of-2">
                                    <lightning-input
                                        label="Contact Email Address"
                                        name="kp2Email"
                                        type="email"
                                        value={formData.kp2Email}
                                        onchange={handleFieldChange}>
                                    </lightning-input>
                                </div>
                            </div>
                        </lightning-accordion-section>
                    </lightning-accordion>

                    <!-- Navigation buttons for Page 2 -->
                    <div class="slds-docked-form-footer slds-m-top_large">
                        <lightning-button 
                            label="Previous" 
                            onclick={handlePrevious}
                            variant="neutral">
                        </lightning-button>
                        <lightning-button 
                            label="Next" 
                            onclick={handleNext}
                            variant="brand"
                            class="slds-m-left_x-small">
                        </lightning-button>
                    </div>
                </div>
            </template>

            <!-- Page 3: Suitability Assessment -->
            <template if:true={showPage3}>
                <div class="slds-p-around_medium">
                    <h2 class="slds-text-heading_large slds-m-bottom_medium">SUITABILITY ASSESSMENT</h2>
                    
                    <div class="slds-notify slds-notify_alert slds-theme_warning slds-theme_alert-texture slds-m-bottom_medium" role="alert">
                        <span class="slds-assistive-text">warning</span>
                        <h2 class="slds-text-heading_small">Suitability Requirements</h2>
                        <p>Section 63D of the Commission Act requires certain matters to be considered when deciding whether an applicant is suitable to provide aged care. Please ensure the responses given below clearly establish why you are suitable to provide aged care.</p>
                    </div>

                    <lightning-accordion allow-multiple-sections-open>
                        <!-- Experience Section -->
                        <lightning-accordion-section name="experience" label="Experience in Providing Care">
                            <div class="slds-m-bottom_medium">
                                <lightning-textarea
                                    label="Describe your organisation's current experience in the delivery of aged care, or if you have no aged care experience, describe your experience delivering other care relevant to the care type you are applying for"
                                    name="experienceDescription"
                                    value={formData.experienceDescription}
                                    onchange={handleFieldChange}
                                    required
                                    message-when-value-missing="Experience description is required"
                                    field-level-help="Relevant care may include delivery of care under the CHSP, NDIS, sub-contract or private fee for service care">
                                </lightning-textarea>
                            </div>
                            
                            <h3 class="slds-text-heading_small slds-m-bottom_small">Services Provided</h3>
                            <p class="slds-text-body_small slds-text-color_weak slds-m-bottom_small">Provide details of the services you provide or have provided. Each item must clearly identify the date commenced/ceased, number of people served during the period, and number continuing to receive services.</p>
                            
                            <div class="slds-grid slds-wrap slds-gutters slds-m-bottom_small">
                                <div class="slds-col slds-size_1-of-1 slds-large-size_1-of-3">
                                    <lightning-input
                                        label="Service Delivered"
                                        name="service1Type"
                                        value={formData.service1Type}
                                        onchange={handleFieldChange}
                                        placeholder="e.g., transport, personal care">
                                    </lightning-input>
                                </div>
                                <div class="slds-col slds-size_1-of-1 slds-large-size_1-of-3">
                                    <lightning-input
                                        label="Period of Delivery"
                                        name="service1Period"
                                        value={formData.service1Period}
                                        onchange={handleFieldChange}
                                        placeholder="e.g., 01/01/2021 to current">
                                    </lightning-input>
                                </div>
                                <div class="slds-col slds-size_1-of-1 slds-large-size_1-of-3">
                                    <lightning-input
                                        label="Number of Care Recipients"
                                        name="service1Recipients"
                                        type="number"
                                        value={formData.service1Recipients}
                                        onchange={handleFieldChange}>
                                    </lightning-input>
                                </div>
                            </div>
                        </lightning-accordion-section>

                        <!-- Governance Systems -->
                        <lightning-accordion-section name="governance" label="Governance Systems">
                            <p class="slds-text-body_regular slds-m-bottom_medium">Describe the governance systems you have in place or will have in place. Your governance systems are the foundation of your organisation and should be appropriately planned for, managed, and monitored.</p>
                            
                            <div class="slds-m-bottom_medium">
                                <h4 class="slds-text-heading_small slds-m-bottom_small">Information Management</h4>
                                <lightning-textarea
                                    label="Detail your current or proposed information management systems, including electronic and off-line systems"
                                    name="informationManagement"
                                    value={formData.informationManagement}
                                    onchange={handleFieldChange}
                                    required
                                    message-when-value-missing="Information management description is required">
                                </lightning-textarea>
                            </div>

                            <div class="slds-m-bottom_medium">
                                <h4 class="slds-text-heading_small slds-m-bottom_small">Continuous Improvement</h4>
                                <lightning-textarea
                                    label="Detail your current or proposed continuous improvement system"
                                    name="continuousImprovement"
                                    value={formData.continuousImprovement}
                                    onchange={handleFieldChange}
                                    required
                                    message-when-value-missing="Continuous improvement description is required">
                                </lightning-textarea>
                            </div>

                            <div class="slds-m-bottom_medium">
                                <h4 class="slds-text-heading_small slds-m-bottom_small">Financial Governance</h4>
                                <lightning-textarea
                                    label="Detail your current or proposed financial governance system, including electronic or off-line systems"
                                    name="financialGovernance"
                                    value={formData.financialGovernance}
                                    onchange={handleFieldChange}
                                    required
                                    message-when-value-missing="Financial governance description is required">
                                </lightning-textarea>
                            </div>

                            <div class="slds-m-bottom_medium">
                                <h4 class="slds-text-heading_small slds-m-bottom_small">Risk and Incident Management</h4>
                                <lightning-textarea
                                    label="What is your current or proposed risk management and incident management system, and how is it or will it be applied in practice?"
                                    name="riskManagement"
                                    value={formData.riskManagement}
                                    onchange={handleFieldChange}
                                    required
                                    message-when-value-missing="Risk management description is required">
                                </lightning-textarea>
                            </div>
                        </lightning-accordion-section>

                        <!-- Financial Management -->
                        <lightning-accordion-section name="financial" label="Financial Management">
                            <div class="slds-m-bottom_medium">
                                <lightning-textarea
                                    label="Provide a detailed description of the policies and procedures you have in place or will develop, implement, and monitor to ensure sound financial management in accordance with the Aged Care Act and associated Principles"
                                    name="financialPolicies"
                                    value={formData.financialPolicies}
                                    onchange={handleFieldChange}
                                    required
                                    message-when-value-missing="Financial policies description is required">
                                </lightning-textarea>
                            </div>

                            <div class="slds-m-bottom_medium">
                                <lightning-textarea
                                    label="Describe your financial management strategy and detail how you plan to become and remain financially viable"
                                    name="financialStrategy"
                                    value={formData.financialStrategy}
                                    onchange={handleFieldChange}
                                    required
                                    message-when-value-missing="Financial strategy is required">
                                </lightning-textarea>
                            </div>

                            <div class="slds-m-bottom_medium">
                                <lightning-textarea
                                    label="The actual financial capital of your organisation - the funds your company has available at its disposal to commence operating as an approved provider"
                                    name="financialCapital"
                                    value={formData.financialCapital}
                                    onchange={handleFieldChange}
                                    required
                                    message-when-value-missing="Financial capital description is required">
                                </lightning-textarea>
                            </div>
                        </lightning-accordion-section>
                    </lightning-accordion>

                    <!-- Navigation buttons for Page 3 -->
                    <div class="slds-docked-form-footer slds-m-top_large">
                        <lightning-button 
                            label="Previous" 
                            onclick={handlePrevious}
                            variant="neutral">
                        </lightning-button>
                        <lightning-button 
                            label="Next" 
                            onclick={handleNext}
                            variant="brand"
                            class="slds-m-left_x-small">
                        </lightning-button>
                    </div>
                </div>
            </template>

            <!-- Page 4: Care Type & Review -->
            <template if:true={showPage4}>
                <div class="slds-p-around_medium">
                    <h2 class="slds-text-heading_large slds-m-bottom_medium">CARE TYPE SPECIFIC REQUIREMENTS & REVIEW</h2>
                    
                    <lightning-accordion allow-multiple-sections-open>
                        <!-- Quality of Care Responsibilities -->
                        <lightning-accordion-section name="qualityOfCare" label="Quality of Care Responsibilities">
                            <p class="slds-text-body_regular slds-m-bottom_medium">Your responses must demonstrate your understanding of the Quality of Care responsibilities set out under Part 4.1 of the Aged Care Act.</p>
                            
                            <div class="slds-m-bottom_medium">
                                <lightning-textarea
                                    label="In your own words, describe the responsibilities set out under section 54-1 of the Aged Care Act and how you will embed these responsibilities into the delivery of care and services within your organisation"
                                    name="qualityResponsibilities"
                                    value={formData.qualityResponsibilities}
                                    onchange={handleFieldChange}
                                    required
                                    message-when-value-missing="Quality responsibilities description is required">
                                </lightning-textarea>
                            </div>

                            <div class="slds-m-bottom_medium">
                                <lightning-textarea
                                    label="Describe how you will develop, implement, and maintain the care and services specified in the Quality of Care Principles as relevant to the type(s) of care you are applying for"
                                    name="careServicesImplementation"
                                    value={formData.careServicesImplementation}
                                    onchange={handleFieldChange}
                                    required
                                    message-when-value-missing="Care services implementation description is required">
                                </lightning-textarea>
                            </div>

                            <div class="slds-m-bottom_medium">
                                <lightning-textarea
                                    label="Describe/detail exactly how you will meet the legislated requirements regarding staffing as set out under section 54-1(1)(b)"
                                    name="staffingRequirements"
                                    value={formData.staffingRequirements}
                                    onchange={handleFieldChange}
                                    required
                                    message-when-value-missing="Staffing requirements description is required">
                                </lightning-textarea>
                            </div>
                        </lightning-accordion-section>

                        <!-- User Rights Responsibilities -->
                        <lightning-accordion-section name="userRights" label="User Rights Responsibilities">
                            <div class="slds-m-bottom_medium">
                                <lightning-textarea
                                    label="In your own words, describe the responsibilities related to charging continuing and future care recipients as they relate to the type(s) of care you are seeking approval to provide"
                                    name="chargingResponsibilities"
                                    value={formData.chargingResponsibilities}
                                    onchange={handleFieldChange}
                                    required
                                    message-when-value-missing="Charging responsibilities description is required">
                                </lightning-textarea>
                            </div>

                            <div class="slds-m-bottom_medium">
                                <lightning-textarea
                                    label="Explain the steps you will take to comply with these responsibilities on a day-to-day basis"
                                    name="complianceSteps"
                                    value={formData.complianceSteps}
                                    onchange={handleFieldChange}
                                    required
                                    message-when-value-missing="Compliance steps description is required">
                                </lightning-textarea>
                            </div>

                            <div class="slds-m-bottom_medium">
                                <lightning-textarea
                                    label="Describe the steps you will take to seek input and feedback from care recipients (and their representatives) and your workforce to inform continuous improvement"
                                    name="feedbackProcess"
                                    value={formData.feedbackProcess}
                                    onchange={handleFieldChange}
                                    required
                                    message-when-value-missing="Feedback process description is required">
                                </lightning-textarea>
                            </div>
                        </lightning-accordion-section>

                        <!-- Accountability Requirements -->
                        <lightning-accordion-section name="accountability" label="Accountability Requirements">
                            <div class="slds-m-bottom_medium">
                                <lightning-textarea
                                    label="Explain your methods for complying with record keeping requirements as set out under Part 6.3 of the Aged Care Act"
                                    name="recordKeeping"
                                    value={formData.recordKeeping}
                                    onchange={handleFieldChange}
                                    required
                                    message-when-value-missing="Record keeping description is required">
                                </lightning-textarea>
                            </div>

                            <div class="slds-m-bottom_medium">
                                <lightning-textarea
                                    label="In your own words, tell us what responsibilities an approved provider must comply with in relation to notification of a change of circumstances that materially affects suitability"
                                    name="changeNotification"
                                    value={formData.changeNotification}
                                    onchange={handleFieldChange}
                                    required
                                    message-when-value-missing="Change notification description is required">
                                </lightning-textarea>
                            </div>

                            <div class="slds-m-bottom_medium">
                                <lightning-textarea
                                    label="Describe the responsibilities of an approved provider as they relate to key personnel and include each specific legislative provision you are referencing"
                                    name="keyPersonnelResponsibilities"
                                    value={formData.keyPersonnelResponsibilities}
                                    onchange={handleFieldChange}
                                    required
                                    message-when-value-missing="Key personnel responsibilities description is required">
                                </lightning-textarea>
                            </div>
                        </lightning-accordion-section>

                        <!-- Application Review -->
                        <lightning-accordion-section name="review" label="Application Review">
                            <div class="slds-notify slds-notify_alert slds-theme_info slds-theme_alert-texture slds-m-bottom_medium" role="alert">
                                <span class="slds-assistive-text">info</span>
                                <h2 class="slds-text-heading_small">Final Review</h2>
                                <p>Please review all information provided in this application. Ensure all required fields are completed and all supporting documentation is attached.</p>
                            </div>

                            <div class="slds-form-element slds-m-bottom_medium">
                                <lightning-input
                                    type="checkbox"
                                    label="I confirm that all information provided in this application is true and accurate"
                                    name="confirmAccuracy"
                                    checked={formData.confirmAccuracy}
                                    onchange={handleFieldChange}
                                    required
                                    message-when-value-missing="You must confirm the accuracy of the information">
                                </lightning-input>
                            </div>

                            <div class="slds-form-element slds-m-bottom_medium">
                                <lightning-input
                                    type="checkbox"
                                    label="I understand the responsibilities and obligations of an approved provider under the Aged Care Act"
                                    name="confirmUnderstanding"
                                    checked={formData.confirmUnderstanding}
                                    onchange={handleFieldChange}
                                    required
                                    message-when-value-missing="You must confirm your understanding">
                                </lightning-input>
                            </div>

                            <div class="slds-form-element slds-m-bottom_medium">
                                <lightning-input
                                    type="checkbox"
                                    label="I consent to the Commissioner obtaining information from other persons or organisations to assist in assessing this application"
                                    name="confirmConsent"
                                    checked={formData.confirmConsent}
                                    onchange={handleFieldChange}
                                    required
                                    message-when-value-missing="Consent is required">
                                </lightning-input>
                            </div>
                        </lightning-accordion-section>
                    </lightning-accordion>

                    <!-- Navigation buttons for Page 4 (Last Page) -->
                    <div class="slds-docked-form-footer slds-m-top_large">
                        <lightning-button 
                            label="Previous" 
                            onclick={handlePrevious}
                            variant="neutral">
                        </lightning-button>
                        <lightning-button 
                            label="Submit Application" 
                            onclick={handleSave}
                            variant="success"
                            class="slds-m-left_x-small"
                            disabled={submitDisabled}>
                        </lightning-button>
                    </div>
                </div>
            </template>
        </div>
    </div>
</template>
