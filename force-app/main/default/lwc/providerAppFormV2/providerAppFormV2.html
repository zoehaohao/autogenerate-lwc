<template>
    <div class="slds-card">
        <!-- Header -->
        <div class="slds-card__header slds-border_bottom">
            <div class="slds-media slds-media_center">
                <div class="slds-media__body">
                    <h2 class="slds-card__header-title slds-text-heading_medium">
                        Application for Approval to Provide Aged Care - New Applicant
                    </h2>
                    <p class="slds-text-body_small slds-text-color_weak">
                        Complete all sections to apply for aged care provider approval
                    </p>
                </div>
            </div>
        </div>

        <!-- Progress Indicator -->
        <div class="slds-card__body slds-p-horizontal_large slds-p-top_medium">
            <lightning-progress-indicator 
                current-step={currentPageString}
                type="path"
                variant="base">
                <lightning-progress-step 
                    label="Key Personnel Declaration" 
                    value="1">
                </lightning-progress-step>
                <lightning-progress-step 
                    label="Applicant Details" 
                    value="2">
                </lightning-progress-step>
                <lightning-progress-step 
                    label="Key Personnel Details" 
                    value="3">
                </lightning-progress-step>
                <lightning-progress-step 
                    label="Suitability Assessment" 
                    value="4">
                </lightning-progress-step>
                <lightning-progress-step 
                    label="Care Type Specific" 
                    value="5">
                </lightning-progress-step>
            </lightning-progress-indicator>
        </div>

        <!-- Loading Spinner -->
        <template if:true={isLoading}>
            <lightning-spinner alternative-text="Loading" size="medium"></lightning-spinner>
        </template>

        <!-- Form Content -->
        <div class="slds-card__body slds-p-horizontal_large">
            
            <!-- Page 1: Key Personnel Declaration -->
            <template if:true={isPage1}>
                <div class="form-section">
                    <h3 class="slds-text-heading_medium slds-m-bottom_medium">Key Personnel Declaration</h3>
                    
                    <div class="slds-notify slds-notify_alert slds-theme_warning slds-theme_alert-texture slds-m-bottom_medium" role="alert">
                        <h4 class="slds-text-heading_small">Important Information</h4>
                        <p class="slds-text-body_regular">
                            Giving false and misleading information is a serious offence. There are offences established by the Commission Act and the Criminal Code Act 1995 (Cth) relating to providing false and misleading information.
                        </p>
                    </div>

                    <div class="slds-text-longform slds-m-bottom_large">
                        <p class="slds-text-body_regular slds-m-bottom_small">
                            Only persons who are lawfully authorised to act on behalf of/represent the organisation (for instance, to enter into contracts) can sign this application form.
                        </p>
                        <p class="slds-text-body_regular slds-m-bottom_medium">
                            I/we declare that I/we:
                        </p>
                    </div>

                    <!-- Declaration Checkboxes -->
                    <div class="slds-form-element slds-m-bottom_medium">
                        <lightning-checkbox-group 
                            name="declarationItems"
                            label="Declaration Items (All items must be acknowledged)"
                            options={declarationOptions}
                            value={selectedDeclarations}
                            onchange={handleDeclarationChange}
                            required>
                        </lightning-checkbox-group>
                    </div>

                    <!-- Declaring Officer 1 -->
                    <div class="slds-section slds-is-open slds-m-bottom_large">
                        <h4 class="slds-section__title slds-theme_shade">
                            <span class="slds-truncate">Declaring Officer 1 – Key Personnel</span>
                        </h4>
                        <div class="slds-section__content">
                            <div class="slds-grid slds-gutters slds-wrap">
                                <div class="slds-col slds-size_1-of-2">
                                    <lightning-input
                                        label="Name"
                                        value={officer1Name}
                                        onchange={handleOfficer1NameChange}
                                        required>
                                    </lightning-input>
                                </div>
                                <div class="slds-col slds-size_1-of-2">
                                    <lightning-input
                                        label="Position"
                                        value={officer1Position}
                                        onchange={handleOfficer1PositionChange}
                                        required>
                                    </lightning-input>
                                </div>
                                <div class="slds-col slds-size_1-of-2">
                                    <lightning-input
                                        label="Signature"
                                        value={officer1Signature}
                                        onchange={handleOfficer1SignatureChange}
                                        field-level-help="Electronic signature or type your full name"
                                        required>
                                    </lightning-input>
                                </div>
                                <div class="slds-col slds-size_1-of-2">
                                    <lightning-input
                                        label="Date"
                                        type="date"
                                        value={officer1Date}
                                        onchange={handleOfficer1DateChange}
                                        required>
                                    </lightning-input>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Declaring Officer 2 -->
                    <div class="slds-section slds-is-open slds-m-bottom_large">
                        <h4 class="slds-section__title slds-theme_shade">
                            <span class="slds-truncate">Declaring Officer 2 – Key Personnel</span>
                        </h4>
                        <div class="slds-section__content">
                            <div class="slds-grid slds-gutters slds-wrap">
                                <div class="slds-col slds-size_1-of-2">
                                    <lightning-input
                                        label="Name"
                                        value={officer2Name}
                                        onchange={handleOfficer2NameChange}>
                                    </lightning-input>
                                </div>
                                <div class="slds-col slds-size_1-of-2">
                                    <lightning-input
                                        label="Position"
                                        value={officer2Position}
                                        onchange={handleOfficer2PositionChange}>
                                    </lightning-input>
                                </div>
                                <div class="slds-col slds-size_1-of-2">
                                    <lightning-input
                                        label="Signature"
                                        value={officer2Signature}
                                        onchange={handleOfficer2SignatureChange}
                                        field-level-help="Electronic signature or type your full name">
                                    </lightning-input>
                                </div>
                                <div class="slds-col slds-size_1-of-2">
                                    <lightning-input
                                        label="Date"
                                        type="date"
                                        value={officer2Date}
                                        onchange={handleOfficer2DateChange}>
                                    </lightning-input>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </template>

            <!-- Page 2: Applicant Details -->
            <template if:true={isPage2}>
                <div class="form-section">
                    <h3 class="slds-text-heading_medium slds-m-bottom_medium">About the Applicant</h3>
                    
                    <!-- Organisation Details -->
                    <div class="slds-section slds-is-open slds-m-bottom_large">
                        <h4 class="slds-section__title slds-theme_shade">
                            <span class="slds-truncate">Organisation Details</span>
                        </h4>
                        <div class="slds-section__content">
                            <div class="slds-grid slds-gutters slds-wrap">
                                <div class="slds-col slds-size_1-of-1">
                                    <lightning-input
                                        label="Applicant's (Company) Legal Name"
                                        value={companyLegalName}
                                        onchange={handleCompanyLegalNameChange}
                                        required>
                                    </lightning-input>
                                </div>
                                <div class="slds-col slds-size_1-of-2">
                                    <lightning-input
                                        label="Applicant's (Company) ACN, IAN or ICN"
                                        value={companyACN}
                                        onchange={handleCompanyACNChange}
                                        required>
                                    </lightning-input>
                                </div>
                                <div class="slds-col slds-size_1-of-2">
                                    <lightning-input
                                        label="Applicant's (Company) ABN"
                                        value={companyABN}
                                        onchange={handleCompanyABNChange}
                                        required>
                                    </lightning-input>
                                </div>
                                <div class="slds-col slds-size_1-of-1">
                                    <lightning-input
                                        label="Business Name (if applicable)"
                                        value={businessName}
                                        onchange={handleBusinessNameChange}>
                                    </lightning-input>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Registered Business Address -->
                    <div class="slds-section slds-is-open slds-m-bottom_large">
                        <h4 class="slds-section__title slds-theme_shade">
                            <span class="slds-truncate">Registered Business Address</span>
                        </h4>
                        <div class="slds-section__content">
                            <p class="slds-text-body_small slds-text-color_weak slds-m-bottom_small">
                                Must be the registered physical address of the organisation
                            </p>
                            <div class="slds-grid slds-gutters slds-wrap">
                                <div class="slds-col slds-size_1-of-1">
                                    <lightning-input
                                        label="Street Number and Name"
                                        value={registeredStreet}
                                        onchange={handleRegisteredStreetChange}
                                        required>
                                    </lightning-input>
                                </div>
                                <div class="slds-col slds-size_1-of-3">
                                    <lightning-input
                                        label="Suburb/Town"
                                        value={registeredSuburb}
                                        onchange={handleRegisteredSuburbChange}
                                        required>
                                    </lightning-input>
                                </div>
                                <div class="slds-col slds-size_1-of-3">
                                    <lightning-combobox
                                        label="State/Territory"
                                        value={registeredState}
                                        placeholder="Select State/Territory"
                                        options={stateOptions}
                                        onchange={handleRegisteredStateChange}
                                        required>
                                    </lightning-combobox>
                                </div>
                                <div class="slds-col slds-size_1-of-3">
                                    <lightning-input
                                        label="Postcode"
                                        value={registeredPostcode}
                                        onchange={handleRegisteredPostcodeChange}
                                        required>
                                    </lightning-input>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Postal Address -->
                    <div class="slds-section slds-is-open slds-m-bottom_large">
                        <h4 class="slds-section__title slds-theme_shade">
                            <span class="slds-truncate">Postal Address</span>
                        </h4>
                        <div class="slds-section__content">
                            <div class="slds-form-element slds-m-bottom_small">
                                <lightning-input
                                    type="checkbox"
                                    label="Same as registered address"
                                    checked={sameAsRegistered}
                                    onchange={handleSameAsRegisteredChange}>
                                </lightning-input>
                            </div>
                            <template if:false={sameAsRegistered}>
                                <div class="slds-grid slds-gutters slds-wrap">
                                    <div class="slds-col slds-size_1-of-1">
                                        <lightning-input
                                            label="Street Number and Name/PO Box"
                                            value={postalStreet}
                                            onchange={handlePostalStreetChange}>
                                        </lightning-input>
                                    </div>
                                    <div class="slds-col slds-size_1-of-3">
                                        <lightning-input
                                            label="Suburb/Town"
                                            value={postalSuburb}
                                            onchange={handlePostalSuburbChange}>
                                        </lightning-input>
                                    </div>
                                    <div class="slds-col slds-size_1-of-3">
                                        <lightning-combobox
                                            label="State/Territory"
                                            value={postalState}
                                            placeholder="Select State/Territory"
                                            options={stateOptions}
                                            onchange={handlePostalStateChange}>
                                        </lightning-combobox>
                                    </div>
                                    <div class="slds-col slds-size_1-of-3">
                                        <lightning-input
                                            label="Postcode"
                                            value={postalPostcode}
                                            onchange={handlePostalPostcodeChange}>
                                        </lightning-input>
                                    </div>
                                </div>
                            </template>
                        </div>
                    </div>

                    <!-- Care Type Selection -->
                    <div class="slds-section slds-is-open slds-m-bottom_large">
                        <h4 class="slds-section__title slds-theme_shade">
                            <span class="slds-truncate">Care Type You Are Applying For</span>
                        </h4>
                        <div class="slds-section__content">
                            <p class="slds-text-body_small slds-text-color_weak slds-m-bottom_small">
                                Select the type(s) of care for which approval is sought. All applicants must complete Sections 2 and 3 of this application form, regardless of the type of care being applied for.
                            </p>
                            <lightning-checkbox-group 
                                name="careTypes"
                                label="Care Types"
                                options={careTypeOptions}
                                value={selectedCareTypes}
                                onchange={handleCareTypeChange}
                                required>
                            </lightning-checkbox-group>
                        </div>
                    </div>
                </div>
            </template>

            <!-- Page 3: Key Personnel Details -->
            <template if:true={isPage3}>
                <div class="form-section">
                    <h3 class="slds-text-heading_medium slds-m-bottom_medium">Your Key Personnel</h3>
                    
                    <div class="slds-notify slds-notify_alert slds-theme_info slds-theme_alert-texture slds-m-bottom_medium" role="alert">
                        <h4 class="slds-text-heading_small">Key Personnel Requirements</h4>
                        <p class="slds-text-body_regular">
                            Your application will be invalid if you do not complete all key personnel fields, have each key personnel sign their individual details, and submit National criminal history checks for all key personnel.
                        </p>
                    </div>

                    <!-- Key Personnel 1 -->
                    <div class="slds-section slds-is-open slds-m-bottom_large">
                        <h4 class="slds-section__title slds-theme_shade">
                            <span class="slds-truncate">Key Personnel 1</span>
                        </h4>
                        <div class="slds-section__content">
                            <div class="slds-grid slds-gutters slds-wrap">
                                <div class="slds-col slds-size_1-of-4">
                                    <lightning-combobox
                                        label="Title"
                                        value={kp1Title}
                                        placeholder="Select Title"
                                        options={titleOptions}
                                        onchange={handleKp1TitleChange}>
                                    </lightning-combobox>
                                </div>
                                <div class="slds-col slds-size_3-of-4">
                                    <lightning-input
                                        label="First and Last Name"
                                        value={kp1Name}
                                        onchange={handleKp1NameChange}
                                        required>
                                    </lightning-input>
                                </div>
                                <div class="slds-col slds-size_1-of-2">
                                    <lightning-input
                                        label="Former Name (as applicable)"
                                        value={kp1FormerName}
                                        onchange={handleKp1FormerNameChange}>
                                    </lightning-input>
                                </div>
                                <div class="slds-col slds-size_1-of-2">
                                    <lightning-input
                                        label="Preferred Name"
                                        value={kp1PreferredName}
                                        onchange={handleKp1PreferredNameChange}>
                                    </lightning-input>
                                </div>
                                <div class="slds-col slds-size_1-of-2">
                                    <lightning-input
                                        label="Date of Birth"
                                        type="date"
                                        value={kp1DateOfBirth}
                                        onchange={handleKp1DateOfBirthChange}
                                        required>
                                    </lightning-input>
                                </div>
                                <div class="slds-col slds-size_1-of-2">
                                    <lightning-input
                                        label="Position Title"
                                        value={kp1PositionTitle}
                                        onchange={handleKp1PositionTitleChange}
                                        required>
                                    </lightning-input>
                                </div>
                                <div class="slds-col slds-size_1-of-2">
                                    <lightning-input
                                        label="Contact Email Address"
                                        type="email"
                                        value={kp1Email}
                                        onchange={handleKp1EmailChange}
                                        required>
                                    </lightning-input>
                                </div>
                                <div class="slds-col slds-size_1-of-2">
                                    <lightning-input
                                        label="Contact Phone Number - Mobile"
                                        type="tel"
                                        value={kp1Mobile}
                                        onchange={handleKp1MobileChange}
                                        required>
                                    </lightning-input>
                                </div>
                                <div class="slds-col slds-size_1-of-1">
                                    <lightning-textarea
                                        label="Principal Duties of Position"
                                        value={kp1Duties}
                                        onchange={handleKp1DutiesChange}
                                        required>
                                    </lightning-textarea>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Key Personnel 2 -->
                    <div class="slds-section slds-is-open slds-m-bottom_large">
                        <h4 class="slds-section__title slds-theme_shade">
                            <span class="slds-truncate">Key Personnel 2</span>
                        </h4>
                        <div class="slds-section__content">
                            <div class="slds-grid slds-gutters slds-wrap">
                                <div class="slds-col slds-size_1-of-4">
                                    <lightning-combobox
                                        label="Title"
                                        value={kp2Title}
                                        placeholder="Select Title"
                                        options={titleOptions}
                                        onchange={handleKp2TitleChange}>
                                    </lightning-combobox>
                                </div>
                                <div class="slds-col slds-size_3-of-4">
                                    <lightning-input
                                        label="First and Last Name"
                                        value={kp2Name}
                                        onchange={handleKp2NameChange}>
                                    </lightning-input>
                                </div>
                                <div class="slds-col slds-size_1-of-2">
                                    <lightning-input
                                        label="Former Name (as applicable)"
                                        value={kp2FormerName}
                                        onchange={handleKp2FormerNameChange}>
                                    </lightning-input>
                                </div>
                                <div class="slds-col slds-size_1-of-2">
                                    <lightning-input
                                        label="Preferred Name"
                                        value={kp2PreferredName}
                                        onchange={handleKp2PreferredNameChange}>
                                    </lightning-input>
                                </div>
                                <div class="slds-col slds-size_1-of-2">
                                    <lightning-input
                                        label="Date of Birth"
                                        type="date"
                                        value={kp2DateOfBirth}
                                        onchange={handleKp2DateOfBirthChange}>
                                    </lightning-input>
                                </div>
                                <div class="slds-col slds-size_1-of-2">
                                    <lightning-input
                                        label="Position Title"
                                        value={kp2PositionTitle}
                                        onchange={handleKp2PositionTitleChange}>
                                    </lightning-input>
                                </div>
                                <div class="slds-col slds-size_1-of-2">
                                    <lightning-input
                                        label="Contact Email Address"
                                        type="email"
                                        value={kp2Email}
                                        onchange={handleKp2EmailChange}>
                                    </lightning-input>
                                </div>
                                <div class="slds-col slds-size_1-of-2">
                                    <lightning-input
                                        label="Contact Phone Number - Mobile"
                                        type="tel"
                                        value={kp2Mobile}
                                        onchange={handleKp2MobileChange}>
                                    </lightning-input>
                                </div>
                                <div class="slds-col slds-size_1-of-1">
                                    <lightning-textarea
                                        label="Principal Duties of Position"
                                        value={kp2Duties}
                                        onchange={handleKp2DutiesChange}>
                                    </lightning-textarea>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </template>

            <!-- Page 4: Suitability Assessment -->
            <template if:true={isPage4}>
                <div class="form-section">
                    <h3 class="slds-text-heading_medium slds-m-bottom_medium">Your Suitability to be an Approved Provider</h3>
                    
                    <!-- Experience Section -->
                    <div class="slds-section slds-is-open slds-m-bottom_large">
                        <h4 class="slds-section__title slds-theme_shade">
                            <span class="slds-truncate">Experience, Conduct and Compliance</span>
                        </h4>
                        <div class="slds-section__content">
                            <div class="slds-form-element slds-m-bottom_medium">
                                <lightning-textarea
                                    label="Describe your organisation's current experience in the delivery of aged care"
                                    value={experienceDescription}
                                    onchange={handleExperienceDescriptionChange}
                                    field-level-help="If you have no aged care experience, describe your experience delivering other care relevant to the care type you are applying for"
                                    required>
                                </lightning-textarea>
                            </div>
                            
                            <div class="slds-form-element slds-m-bottom_medium">
                                <label class="slds-form-element__label">Has the applicant organisation at any time been convicted of an indictable offence?</label>
                                <lightning-radio-group
                                    name="indictableOffence"
                                    options={yesNoOptions}
                                    value={indictableOffence}
                                    onchange={handleIndictableOffenceChange}
                                    type="radio"
                                    required>
                                </lightning-radio-group>
                            </div>

                            <template if:true={showIndictableOffenceDetails}>
                                <div class="slds-form-element slds-m-bottom_medium">
                                    <lightning-textarea
                                        label="Provide details of indictable offence"
                                        value={indictableOffenceDetails}
                                        onchange={handleIndictableOffenceDetailsChange}
                                        required>
                                    </lightning-textarea>
                                </div>
                            </template>

                            <div class="slds-form-element slds-m-bottom_medium">
                                <label class="slds-form-element__label">Has a civil penalty order been made against the applicant organisation at any time?</label>
                                <lightning-radio-group
                                    name="civilPenalty"
                                    options={yesNoOptions}
                                    value={civilPenalty}
                                    onchange={handleCivilPenaltyChange}
                                    type="radio"
                                    required>
                                </lightning-radio-group>
                            </div>

                            <template if:true={showCivilPenaltyDetails}>
                                <div class="slds-form-element slds-m-bottom_medium">
                                    <lightning-textarea
                                        label="Provide details of civil penalty order"
                                        value={civilPenaltyDetails}
                                        onchange={handleCivilPenaltyDetailsChange}
                                        required>
                                    </lightning-textarea>
                                </div>
                            </template>
                        </div>
                    </div>

                    <!-- Governance Systems -->
                    <div class="slds-section slds-is-open slds-m-bottom_large">
                        <h4 class="slds-section__title slds-theme_shade">
                            <span class="slds-truncate">Governance Systems</span>
                        </h4>
                        <div class="slds-section__content">
                            <div class="slds-form-element slds-m-bottom_medium">
                                <lightning-textarea
                                    label="Information Management System"
                                    value={informationManagement}
                                    onchange={handleInformationManagementChange}
                                    field-level-help="Detail your current or proposed information management systems, including electronic and off-line systems"
                                    required>
                                </lightning-textarea>
                            </div>

                            <div class="slds-form-element slds-m-bottom_medium">
                                <lightning-textarea
                                    label="Continuous Improvement System"
                                    value={continuousImprovement}
                                    onchange={handleContinuousImprovementChange}
                                    field-level-help="Detail your current or proposed continuous improvement system"
                                    required>
                                </lightning-textarea>
                            </div>

                            <div class="slds-form-element slds-m-bottom_medium">
                                <lightning-textarea
                                    label="Financial Governance System"
                                    value={financialGovernance}
                                    onchange={handleFinancialGovernanceChange}
                                    field-level-help="Detail your current or proposed financial governance system, including electronic or off-line systems"
                                    required>
                                </lightning-textarea>
                            </div>

                            <div class="slds-form-element slds-m-bottom_medium">
                                <lightning-textarea
                                    label="Risk and Incident Management System"
                                    value={riskManagement}
                                    onchange={handleRiskManagementChange}
                                    field-level-help="What is your current or proposed risk management and incident management system, and how is it or will it be applied in practice?"
                                    required>
                                </lightning-textarea>
                            </div>
                        </div>
                    </div>

                    <!-- Financial Management -->
                    <div class="slds-section slds-is-open slds-m-bottom_large">
                        <h4 class="slds-section__title slds-theme_shade">
                            <span class="slds-truncate">Financial Management</span>
                        </h4>
                        <div class="slds-section__content">
                            <div class="slds-form-element slds-m-bottom_medium">
                                <lightning-textarea
                                    label="Financial Management Strategy"
                                    value={financialStrategy}
                                    onchange={handleFinancialStrategyChange}
                                    field-level-help="Describe your financial management strategy and detail how you plan to become and remain financially viable"
                                    required>
                                </lightning-textarea>
                            </div>

                            <div class="slds-form-element slds-m-bottom_medium">
                                <lightning-input
                                    label="Available Financial Capital (AUD)"
                                    type="number"
                                    value={financialCapital}
                                    onchange={handleFinancialCapitalChange}
                                    formatter="currency"
                                    step="0.01"
                                    required>
                                </lightning-input>
                            </div>

                            <div class="slds-form-element slds-m-bottom_medium">
                                <lightning-textarea
                                    label="Start-up Budget Allocation"
                                    value={startupBudget}
                                    onchange={handleStartupBudgetChange}
                                    field-level-help="Provide a detailed statement that establishes the allocated budget you have identified that you will require to commence the delivery of aged care services"
                                    required>
                                </lightning-textarea>
                            </div>
                        </div>
                    </div>
                </div>
            </template>

            <!-- Page 5: Care Type Specific -->
            <template if:true={isPage5}>
                <div class="form-section">
                    <h3 class="slds-text-heading_medium slds-m-bottom_medium">Care Type Specific Requirements</h3>
                    
                    <!-- Home Care Section -->
                    <template if:true={showHomeCareSection}>
                        <div class="slds-section slds-is-open slds-m-bottom_large">
                            <h4 class="slds-section__title slds-theme_shade">
                                <span class="slds-truncate">Home Care Requirements</span>
                            </h4>
                            <div class="slds-section__content">
                                <div class="slds-form-element slds-m-bottom_medium">
                                    <lightning-textarea
                                        label="Care Delivery Systems"
                                        value={homeCareDelivery}
                                        onchange={handleHomeCareDeliveryChange}
                                        field-level-help="Detail the systems, policies, or procedures you have/will develop, implement and monitor to deliver home care from referral to delivery"
                                        required>
                                    </lightning-textarea>
                                </div>

                                <div class="slds-form-element slds-m-bottom_medium">
                                    <lightning-textarea
                                        label="Health Status Monitoring Tools"
                                        value={healthMonitoring}
                                        onchange={handleHealthMonitoringChange}
                                        field-level-help="What tools or methods will you implement to accurately capture care recipient current and future health status?"
                                        required>
                                    </lightning-textarea>
                                </div>

                                <div class="slds-form-element slds-m-bottom_medium">
                                    <lightning-textarea
                                        label="Medication Management"
                                        value={medicationManagement}
                                        onchange={handleMedicationManagementChange}
                                        field-level-help="Detail the systems, policies, or procedures you have/will develop to manage medication correctly and safely"
                                        required>
                                    </lightning-textarea>
                                </div>

                                <div class="slds-form-element slds-m-bottom_medium">
                                    <lightning-textarea
                                        label="Choice and Flexibility Provision"
                                        value={choiceFlexibility}
                                        onchange={handleChoiceFlexibilityChange}
                                        field-level-help="Describe how you will provide choice and flexibility of care to care recipients in their home care package"
                                        required>
                                    </lightning-textarea>
                                </div>
                            </div>
                        </div>
                    </template>

                    <!-- Residential Care Section -->
                    <template if:true={showResidentialCareSection}>
                        <div class="slds-section slds-is-open slds-m-bottom_large">
                            <h4 class="slds-section__title slds-theme_shade">
                                <span class="slds-truncate">Residential Care Requirements</span>
                            </h4>
                            <div class="slds-section__content">
                                <div class="slds-form-element slds-m-bottom_medium">
                                    <lightning-textarea
                                        label="Prudential Standards Compliance"
                                        value={prudentialStandards}
                                        onchange={handlePrudentialStandardsChange}
                                        field-level-help="Describe what systems, policies, or procedures you have/will develop to ensure you comply with the Prudential Standards"
                                        required>
                                    </lightning-textarea>
                                </div>

                                <div class="slds-form-element slds-m-bottom_medium">
                                    <lightning-textarea
                                        label="Refundable Deposits Management"
                                        value={refundableDeposits}
                                        onchange={handleRefundableDepositsChange}
                                        field-level-help="Describe what reporting procedures and mechanisms you have to manage refundable deposits"
                                        required>
                                    </lightning-textarea>
                                </div>

                                <div class="slds-form-element slds-m-bottom_medium">
                                    <lightning-textarea
                                        label="Facility Financing Plan"
                                        value={facilityFinancing}
                                        onchange={handleFacilityFinancingChange}
                                        field-level-help="Describe how you will finance the purchase, construction and/or lease of a residential aged care facility"
                                        required>
                                    </lightning-textarea>
                                </div>

                                <div class="slds-form-element slds-m-bottom_medium">
                                    <lightning-textarea
                                        label="Restrictive Practices Management"
                                        value={restrictivePractices}
                                        onchange={handleRestrictivePracticesChange}
                                        field-level-help="Describe the responsibilities of an approved provider in relation to the use of restrictive practices"
                                        required>
                                    </lightning-textarea>
                                </div>
                            </div>
                        </div>
                    </template>

                    <!-- Flexible Care Section -->
                    <template if:true={showFlexibleCareSection}>
                        <div class="slds-section slds-is-open slds-m-bottom_large">
                            <h4 class="slds-section__title slds-theme_shade">
                                <span class="slds-truncate">Flexible Care Requirements</span>
                            </h4>
                            <div class="slds-section__content">
                                <div class="slds-form-element slds-m-bottom_medium">
                                    <lightning-textarea
                                        label="Flexible Care Experience"
                                        value={flexibleCareExperience}
                                        onchange={handleFlexibleCareExperienceChange}
                                        field-level-help="Describe from an experience perspective, how flexible care is to be provided"
                                        required>
                                    </lightning-textarea>
                                </div>

                                <div class="slds-form-element slds-m-bottom_medium">
                                    <lightning-textarea
                                        label="Short-term Restorative Care Policies"
                                        value={restorativeCare}
                                        onchange={handleRestorativeCareChange}
                                        field-level-help="Describe what policies, procedures, or forms you have to effectively deliver short-term restorative care"
                                        required>
                                    </lightning-textarea>
                                </div>

                                <div class="slds-form-element slds-m-bottom_medium">
                                    <lightning-textarea
                                        label="Multi-disciplinary Teams"
                                        value={multidisciplinaryTeams}
                                        onchange={handleMultidisciplinaryTeamsChange}
                                        field-level-help="Describe the responsibilities in relation to multi-disciplinary teams in the delivery of flexible care"
                                        required>
                                    </lightning-textarea>
                                </div>
                            </div>
                        </div>
                    </template>
                </div>
            </template>

            <!-- Error Messages -->
            <template if:true={hasErrors}>
                <div class="slds-notify slds-notify_alert slds-theme_error slds-theme_alert-texture slds-m-bottom_medium" role="alert">
                    <h4 class="slds-text-heading_small">Please correct the following errors:</h4>
                    <ul class="slds-list_dotted">
                        <template for:each={errorMessages} for:item="error">
                            <li key={error}>{error}</li>
                        </template>
                    </ul>
                </div>
            </template>
        </div>

        <!-- Navigation Footer -->
        <div class="slds-card__footer">
            <div class="slds-grid slds-grid_align-spread">
                <div class="slds-col">
                    <template if:false={isFirstPage}>
                        <lightning-button
                            label="Previous"
                            onclick={handlePrevious}
                            variant="neutral">
                        </lightning-button>
                    </template>
                </div>
                <div class="slds-col">
                    <lightning-button
                        label="Cancel"
                        onclick={handleCancel}
                        variant="neutral"
                        class="slds-m-right_small">
                    </lightning-button>
                    <template if:false={isLastPage}>
                        <lightning-button
                            label="Next"
                            onclick={handleNext}
                            variant="brand">
                        </lightning-button>
                    </template>
                    <template if:true={isLastPage}>
                        <lightning-button
                            label="Submit Application"
                            onclick={handleSubmit}
                            variant="brand"
                            disabled={isSubmitting}>
                        </lightning-button>
                    </template>
                </div>
            </div>
        </div>
    </div>
</template>
